### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ª–µ–∫—Ü–∏–∏: –ó–∞—â–∏—Ç–∞ –æ—Ç XSS (Cross-Site Scripting) –∞—Ç–∞–∫

#### **1. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏**

```php
<?php
// –û–ø–∞—Å–Ω—ã–π –∫–æ–¥ –±–µ–∑ –∑–∞—â–∏—Ç—ã
$firstName = $_POST['first_name'] ?? '';
?>

<form method="POST">
  <input type="text" name="first_name" value="<?= $firstName ?>">
  <input type="submit" value="Submit">
</form>
```

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ü—Ä–∏ –≤–≤–æ–¥–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –∫–∞–≤—ã—á–∫–æ–π: `Yann"` ‚Üí –ª–æ–º–∞–µ—Ç HTML-—Å—Ç—Ä—É–∫—Ç—É—Ä—É:
  ```html
  <input value="Yann"">
  <!-- –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π HTML -->
  ```
- –ü—Ä–∏ –≤–≤–æ–¥–µ HTML-—Ç–µ–≥–æ–≤: `Yann"><strong>Hello</strong>` ‚Üí –≤–Ω–µ–¥—Ä—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π HTML:
  ```html
  <input value="Yann" /><strong>Hello</strong>">
  ```
- –ü—Ä–∏ –≤–≤–æ–¥–µ JavaScript: `Yann"><script>alert('Hacked!');</script>` ‚Üí –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∫–æ–¥:
  ```html
  <input value="Yann" />
  <script>
    alert("Hacked!");
  </script>
  ">
  ```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- –ö—Ä–∞–∂–∞ —Å–µ—Å—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ñ–∏—à–∏–Ω–≥–æ–≤—ã–µ —Å–∞–π—Ç—ã
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–∞–π—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–º–µ–Ω–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤)

---

#### **2. –ú–µ—Ö–∞–Ω–∏–∑–º –∞—Ç–∞–∫–∏ XSS**

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ –≤ —Ñ–æ—Ä–º—É
2. –°–µ—Ä–≤–µ—Ä –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç/–≤—ã–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ
3. –ë—Ä–∞—É–∑–µ—Ä –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç –∫–æ–¥ –∫–∞–∫ —á–∞—Å—Ç—å HTML/JS
4. –ö–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Å–∞–π—Ç–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ **–ª—é–±–æ–º** –≤—ã–≤–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö:
  ```php
  <h2><?= $_GET['book'] ?></h2> <!-- –¢–∞–∫–∂–µ —É—è–∑–≤–∏–º–æ! -->
  ```
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç —á–∞—Å—Ç—å –∞—Ç–∞–∫, –Ω–æ –Ω–µ –≤—Å–µ

---

#### **3. –ó–∞—â–∏—Ç–∞ —Å –ø–æ–º–æ—â—å—é htmlspecialchars()**

```php
<?php
// –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã–≤–æ–¥
$safeFirstName = htmlspecialchars(
  $firstName,
  ENT_QUOTES, // –≠–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç ' –∏ "
  'UTF-8'     // –ö–æ–¥–∏—Ä–æ–≤–∫–∞
);
?>
<input value="<?= $safeFirstName ?>">
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è:**
| –°–∏–º–≤–æ–ª | –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ | –†–µ–∑—É–ª—å—Ç–∞—Ç –≤ HTML |
|--------|----------------|------------------------|
| `"` | ‚Üí `&quot;` | –ù–µ –ª–æ–º–∞–µ—Ç –∞—Ç—Ä–∏–±—É—Ç—ã |
| `'` | ‚Üí `&#039;` | –ó–∞—â–∏—â–∞–µ—Ç –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ |
| `<` | ‚Üí `&lt;` | –ë–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–µ–≥–∏ |
| `>` | ‚Üí `&gt;` | –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ —Ç–µ–≥–æ–≤ |

**–ü—Ä–∏–º–µ—Ä –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:**

```php
// –í–≤–æ–¥:
Yann"><script>alert(1);</script>

// –í—ã–≤–æ–¥ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏:
Yann&quot;&gt;&lt;script&gt;alert(1);&lt;/script&gt;

// –ò—Ç–æ–≥–æ–≤—ã–π HTML:
<input value="Yann&quot;&gt;&lt;script&gt;alert(1);&lt;/script&gt;">
```

---

#### **4. –§—É–Ω–∫—Ü–∏—è-–ø–æ–º–æ—â–Ω–∏–∫ e()**

```php
<?php
// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
function e(string $str): string {
  return htmlspecialchars($str, ENT_QUOTES, 'UTF-8');
}
?>

<!-- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ -->
<input value="<?= e($firstName) ?>">
<h2><?= e($_GET['book']) ?></h2>
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- –£–ø—Ä–æ—â–∞–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –°–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ –æ—à–∏–±–æ–∫

---

#### **5. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞**

1. **–≠–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ –í–°–ï –≤—ã–≤–æ–¥—ã –¥–∞–Ω–Ω—ã—Ö**  
   –î–∞–∂–µ –¥–ª—è "–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö" –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:

   ```php
   // ‚ùå –û–ø–∞—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É—è–∑–≤–∏–º)
   echo $internalData;

   // ‚úÖ –í—Å–µ–≥–¥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ
   echo e($internalData);
   ```

2. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–≤–æ–¥–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é**  
   –û—Å–æ–±–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ –º–µ—Å—Ç–∞:

   ```php
   <div><?= $_POST['content'] ?></div>          <!-- ‚ùå -->
   <script>var user = '<?= $_GET['name'] ?>';</script> <!-- ‚ùå -->
   ```

3. **–ò–∑–±–µ–≥–∞–π—Ç–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ –≤ production**
   ```php
   // ‚ùå –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
   print_r($_POST);
   var_dump($_SESSION);
   ```

---

#### **6. –ü–æ—á–µ–º—É —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω—É–∂–Ω–æ –≤—Å–µ–≥–¥–∞**

**–°—Ü–µ–Ω–∞—Ä–∏–π –æ—Ç–∫–∞–∑–∞ –æ—Ç e() –¥–ª—è "–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö" –¥–∞–Ω–Ω—ã—Ö:**

```php
<?php
// –ò—Å—Ö–æ–¥–Ω–æ "–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ" –¥–∞–Ω–Ω—ã–µ
$header = '<h1>Welcome</h1>';

// –ü–æ–∑–∂–µ –≤ –∫–æ–¥–µ (–ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞):
$header = getUserGeneratedHeader(); // ‚Üê –ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å XSS!

// –ë–µ–∑ e() - —É—è–∑–≤–∏–º–æ—Å—Ç—å
echo $header;
```

**–†–µ—à–µ–Ω–∏–µ:**

```php
// ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –ø—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
echo e($header);
```

---

### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞

```php
<?php
// –§—É–Ω–∫—Ü–∏—è –∑–∞—â–∏—Ç—ã –æ—Ç XSS
function e(string $str): string {
  return htmlspecialchars($str, ENT_QUOTES, 'UTF-8');
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
$firstName = $_POST['first_name'] ?? '';
?>

<!-- –ó–∞—â–∏—â–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ -->
<form method="POST">
  <input type="text" name="first_name" value="<?= e($firstName) ?>">
  <input type="submit" value="Submit">
</form>

<!-- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã–≤–æ–¥ -->
<?php if (!empty($firstName)): ?>
  <div>You entered: <?= e($firstName) ?></div>
<?php endif; ?>
```

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **XSS - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å**  
   –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π JavaScript –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

2. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ htmlspecialchars()**  
   –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: `ENT_QUOTES` –∏ `UTF-8`

3. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é-–ø–æ–º–æ—â–Ω–∏–∫ e()**  
   –î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

4. **–≠–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ –õ–Æ–ë–û–ô –≤—ã–≤–æ–¥ –≤ HTML**  
   –î–∞–∂–µ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ "–Ω–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"

> üîí **–ó–æ–ª–æ—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**  
> "–í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –∑–ª–æ. –í—Å–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã."
