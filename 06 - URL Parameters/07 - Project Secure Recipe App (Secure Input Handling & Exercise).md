### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ª–µ–∫—Ü–∏–∏: –£—è–∑–≤–∏–º–æ—Å—Ç–∏ Path Traversal –∏ –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ "–±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫"

#### **1. –ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –ø—Ä–∏ –Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ**

**–ò—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**

```php
// –û–ø–∞—Å–Ω—ã–π –∫–æ–¥ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏
$page = $_GET['page']; // Warning: undefined index
echo file_get_contents("pages/$page.html");
```

**–†–µ—à–µ–Ω–∏–µ:**

```php
// –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
if (!empty($_GET['page'])) {
    $filePath = 'pages/' . $_GET['page'] . '.html';
    echo file_get_contents($filePath);
}
```

---

#### **2. –£—è–∑–≤–∏–º–æ—Å—Ç—å Path Traversal Attack**

**–°—É—Ç—å –∞—Ç–∞–∫–∏:**

```php
// –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∏–∑–º–µ–Ω—è–µ—Ç URL:
// include.php?page=../../secret

// –°–µ—Ä–≤–µ—Ä –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å:
file_get_contents('pages/../../secret.html');
// –†–µ–∑—É–ª—å—Ç–∞—Ç: /secret.html (–≤—ã—Ö–æ–¥ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –ø–∞–ø–∫–∏ pages)
```

**–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è:**

1. –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª `secret.html` –≤–Ω–µ –ø–∞–ø–∫–∏ `pages`
2. –í URL —É–∫–∞–∑—ã–≤–∞–µ–º: `?page=../../secret`
3. –°–µ—Ä–≤–µ—Ä –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —Ñ–∞–π–ª:
   ```html
   <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ secret.html -->
   Confidential information!
   ```

---

#### **3. –û—à–∏–±–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ POST**

```php
<form method="POST"> <!-- ‚ùå –ù–µ –∑–∞—â–∏—â–∞–µ—Ç! -->
  <select name="page">
    <option value="citrus_salmon">Citrus Salmon</option>
  </select>
</form>
```

**–ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å HTML —á–µ—Ä–µ–∑ DevTools:
   ```html
   <!-- –ò–∑–º–µ–Ω–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ -->
   <option value="../../secret">Hacked</option>
   ```
2. POST-–¥–∞–Ω–Ω—ã–µ –ª–µ–≥–∫–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è

---

#### **4. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: "–ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫" (Allow List)**

```php
<?php
// –®–∞–≥ 1: –°–æ–∑–¥–∞–µ–º "–±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫" —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
$allowedPages = [
    'citrus_salmon',
    'mediterranean_pasta',
    'vegetable_risotto',
    'spicy_tacos'
];

// –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–≤–æ–¥
if (!empty($_GET['page']) && in_array($_GET['page'], $allowedPages)) {
    // –®–∞–≥ 3: –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    $filePath = 'pages/' . $_GET['page'] . '.html';
    echo file_get_contents($filePath);
}
?>
```

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**

1. –¢–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ `$allowedPages` —Ä–∞–∑—Ä–µ—à–µ–Ω—ã
2. `../../secret` –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫—É `in_array()`
3. –î–∞–∂–µ –µ—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∏–∑–º–µ–Ω–∏—Ç URL, —Ñ–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è

---

#### **5. –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥**

**–¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤:**

```php
// –ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)
$allowedPages = [
    'citrus_salmon',
    'mediterranean_pasta',
    // ...
];

// –ù—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤:
$recipes = [
    'citrus_salmon' => 'Citrus Salmon',
    'mediterranean_pasta' => 'Mediterranean Pasta',
    // ...
];
```

**–¶–µ–ª–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**

1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ —á–µ—Ä–µ–∑ —Ü–∏–∫–ª
2. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
3. –£–ø—Ä–æ—â–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤

---

#### **6. –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è**

```php
<?php
// –ê—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤ —Ä–µ—Ü–µ–ø—Ç–æ–≤
$recipes = [
    'citrus_salmon' => 'Citrus Salmon',
    'mediterranean_pasta' => 'Mediterranean Pasta',
    'vegetable_risotto' => 'Vegetable Risotto',
    'spicy_tacos' => 'Spicy Tacos'
];

// "–ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫" –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
$allowedPages = array_keys($recipes);
?>

<form method="GET">
  <select name="page">
    <option value="">Please select a recipe</option>
    <?php foreach ($recipes as $file => $name): ?>
      <option value="<?= e($file) ?>"
        <?= (!empty($_GET['page']) && $_GET['page'] === $file) ? 'selected' : '' ?>
      >
        <?= e($name) ?>
      </option>
    <?php endforeach; ?>
  </select>
  <input type="submit" value="Submit">
</form>

<?php
// –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
if (!empty($_GET['page']) && in_array($_GET['page'], $allowedPages)) {
    $filePath = 'pages/' . $_GET['page'] . '.html';

    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
    if (file_exists($filePath)) {
        echo file_get_contents($filePath);
    }
}
?>
```

**–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

1. –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (`$recipes`)
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è `<option>`
3. –ó–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ñ–æ—Ä–º—ã –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `e()` –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

### –°—Ö–µ–º–∞ –∑–∞—â–∏—Ç—ã

```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥] --> B{–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–µ–ª–æ–º —Å–ø–∏—Å–∫–µ}
    B -->|–†–∞–∑—Ä–µ—à–µ–Ω| C[–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞]
    B -->|–ó–∞–ø—Ä–µ—â–µ–Ω| D[–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞]
    C --> E[–í—ã–≤–æ–¥ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ]
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ "–±–µ–ª—ã–µ —Å–ø–∏—Å–∫–∏"**  
   –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ "—á–µ—Ä–Ω—ã–µ —Å–ø–∏—Å–∫–∏"

   ```php
   // ‚ùå –û–ø–∞—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥
   if ($page !== 'hack') {...}

   // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥
   $allowed = ['safe1', 'safe2'];
   if (in_array($page, $allowed)) {...}
   ```

2. **–•—Ä–∞–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –ª–æ–≥–∏–∫–∏**  
   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞—Å—Å–∏–≤—ã/–æ–±—ä–µ–∫—Ç—ã –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

3. **–≠–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ –≤—Å–µ –≤—ã–≤–æ–¥—ã**  
   –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `e()` –ø—Ä–∏ –≤—ã–≤–æ–¥–µ –≤ HTML

4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤**
   ```php
   if (file_exists($path) && is_file($path)) {
       // –î–µ–π—Å—Ç–≤–∏—è —Å —Ñ–∞–π–ª–æ–º
   }
   ```

> üîí **–§–∏–ª–æ—Å–æ—Ñ–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**  
> "–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–≤–µ—Ä—è–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º—É –≤–≤–æ–¥—É.  
> –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –∑–ª–æ, –ø–æ–∫–∞ –Ω–µ –¥–æ–∫–∞–∑–∞–Ω–æ –æ–±—Ä–∞—Ç–Ω–æ–µ."
